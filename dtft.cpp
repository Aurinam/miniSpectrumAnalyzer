//on branch experiment
#include <iostream>
#include <fstream>
#include <complex>
#include <vector>
#include <cmath>
#include <utility>

using namespace std;
const double PI = 3.14159265358979323846;

vector<pair<double, double>> dtft(vector<double> x)
{
	int cycles = 4;
	vector<pair<double, double>> X;
	int N = x.size();
	int k = -cycles * N;
	//cout << "Resolution: " << (-cycles * k) << endl;
	while (k <= (cycles * N))
	{
		double re = 0;
		double im = 0;
		for (int n = 0; n < N; n++)
		{
			const double phi = 2 * PI * k * n / N;
			re += x[n] * cos(phi);
			im -= x[n] * sin(phi);
		}
		pair<double, double> temp;
		double mag = sqrt(re * re + im * im);
		double angle = atan(im/re);
        //cout << angle << endl;
		temp.first = mag;
		temp.second = angle;
		X.push_back(temp);
		k++;
	}
	return X;
}

int main()
{
	vector<double> x;
	/*int number;
	ifstream file("signal.txt");
	if (file.is_open()) {
		while (file >> number) {
			x.push_back(number);
		}

		file.close();
		std::cout << "Data from file:" << std::endl;
		for (const int& num : x) {
			std::cout << num << " ";
		}
	}
	else {
		std::cerr << "Unable to open file." << std::endl;
	}*/

    // single gate pulse
	//x = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 01, 01, 01, 01, 01, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    // periodic gate pulse
    //x = {1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,}; 
    // cosine wave
    x = {1.0, 0.9202763834115076, 0.6938172437299284, 0.3567308642051302, -0.037235264606010475, -0.4252643334991101, -0.7454861810469219, -0.9468423196551252, -0.9972270701394408, -0.8886067234408316, -0.6383004933071154, -0.28621901558007534, 0.11149929226384798, 0.4914393464551088, 0.7930207565797969, 0.9681572012159172, 0.9889236588377862, 0.8520089752347099, 0.579243817888501, 0.21411983644509733, -0.18514496048778642, -0.5548889057342297, -0.8361573502407452, -0.984102818750775, -0.9751358156493221, -0.8106861047708024, -0.5169747375115512, -0.14083317873368514, 0.2577638407327867, 0.6152611289813428, 0.8746567325324758, 0.9945907401016836, 0.9559400060182284, 0.7648672828919766, 0.451838587761001, 0.06676547996893763, -0.32895319887590624, -0.6722212003152684, -0.9083053912814495, -0.9995628007280649, -0.931442687211952, -0.7148066143569577, -0.38419660458613847, 0.007672490781932545, 0.3983182287232485, 0.725453227170685, 0.9369167157464414, 0.9989914262791602, 0.901779717924137, 0.6607817286109886, 0.3144239209369128, -0.08206791097521278, -0.46547424154972555, -0.7746619921939791, -0.9603320315355318, -0.992879785517511, -0.8671156048213652, -0.6030922400918649, -0.24290748632920695, 0.15600819404661925, 0.5300487995287738, 0.8195745904772832, 0.9784214805920295, 0.9812617727454477, 0.8276425902122612, 0.5420580866102966, 0.17004392087710987, -0.22908327755849814, -0.5916837812202884, -0.8599419430508073, -0.9910847413690348, -0.9642018198320422, -0.783579585898617, -0.4780177550196898, -0.09623731569339937, 0.30088789734858357, 0.6500373676618942, 0.8955401782398655, 0.9982515851986665, 0.941794538883001, 0.7351709591212445, 0.41132640401553655, 0.021896991856912743, -0.3710238350681948, -0.7047859380489647, -0.9261718732257815, -0.9998822657704023, -0.914164197535198, -0.6826851773335478, -0.34235389447512427, 0.05256476962472326, 0.43910212664532305, 0.7556258644901961, 0.9516671489251403, 0.9959677395585412, 0.8814640297857971, 0.6264133193186724, 0.2714827382609743, -0.12673501426774764, -0.5047452194248315, -0.802275195885316, -0.9718846121153635, -0.9865297159763291, -0.8438753861779925, -0.5666674609074155, -0.19910597686372394, 0.20020240429988914, 0.5675890660225048, 0.8444752215863233, 0.9867121395816812, 0.9716205369785975, 0.8016067280563401, 0.5037789442494437, 0.12562500164915108, -0.2725594998819528, -0.6272851432807767, -0.8819919061704523, -0.9960674999367545, -0.9513228867806248, -0.7548924714693825, -0.4380965402362114, -0.05144732779796676, 0.34340501871201307, 0.6835023851292718, 0.9146171873677982, 0.9998988096644134, 0.9257493333030774, 0.7039916871311275, 0.36998451426652174, -0.02301566571621147, -0.4123460614807684, -0.73592901863079, -0.9421701299454784, -0.9981848208583601, -0.8950417038861123, -0.6491866636512096, -0.29982060608172384, 0.09735101757693944, 0.4790002908359957, 0.7842742930302815, 0.9644979291490531, 0.9909350390600767, 0.8593702987348438, 0.5907813420018613, 0.22799393487409};
// sine wave
//x = {0.0, 0.3912689332607891, 0.720151117685035, 0.9342071989250891, 0.9993065270825165, 0.9050691944009351, 0.6665210828384021, 0.32169802876315795, -0.07441888591686176, -0.45866991514132416, -0.7697872954549804, -0.9581642213735454, -0.9937645132649188, -0.8709118030867279, -0.6091946155651793, -0.250343032125446, 0.1484250551318267, 0.5235271780141882, 0.8151543408692327, 0.9768073994604692, 0.9827112208609282, 0.8319244570831352, 0.5484896404111711, 0.17759966814940648, -0.22160807981193165, -0.5854810325975929, -0.8560006546579639, -0.990033340735435, -0.966207949879674, -0.7883233747419922, -0.4847428186529565, -0.103871361327294, 0.29356209716833237, 0.644187891504835, 0.8920997088947761, 0.9977686959834515, 0.9443462251469577, 0.7403503615496515, 0.4183076812216731, 0.029566998506218765, -0.36388806031440185, -0.6993221747317495, -0.9232513032888079, -0.9999705660094207, -0.9172472887214079, -0.6882714691076758, -0.3495526680700663, 0.04490133874094826, 0.43219595132377603, 0.750578115277733, 0.9492826754674595, 0.9966267395510541, 0.8850614275030337, 0.6323755196479821, 0.27885908485620187, -0.11912065946216578, -0.4981069442150733, -0.7976714548866447, -0.9700494590922806, -0.9877557610008217, -0.8479671397631547, -0.5729725042652514, -0.2066189882757655, 0.19267935371611902, 0.5612555058676388, 0.8403410205032147, 0.9854364844944291, 0.9734068275613522, 0.8061701452180314, 0.5103918637498076, 0.13323301177063232, -0.26516947530320695, -0.6212914232169571, -0.8783501727021723, -0.9953584173894995, -0.9536595164046486, -0.7599022441361752, -0.4449806615552072, -0.059108143671997085, 0.3361890041779407, 0.6778817454871826, 0.911488118057305, 0.9997602321294933, 0.9286233433482539, 0.7094200318065743, 0.3771016590330079, -0.015344529899822299, -0.4053440759957243, -0.7307126306894266, -0.939571078172224, -0.9986175168673438, -0.8984371554958949, -0.6550034754972249, -0.30713130360921365, 0.08971210486132722, 0.47225116642924597, 0.7794910861454176, 0.9624433088895799, 0.9919366089415965, 0.8632683612109149, 0.596954361795923, 0.2354576410596385, -0.16358214907398494, -0.5365392181406164, -0.8239465933837841, -0.9799779640263051, -0.9797545597304173, -0.8233120016929795, -0.5355946229441911, -0.16247816346248117, 0.2365449896349993, 0.5978516986133006, 0.8638326083975505, 0.9920777988447533, 0.9621389291698469, 0.7787896693069416, 0.4712645514462255, 0.08859760476301597, -0.3081959848657645, -0.655848577431443, -0.8989279289426164, -0.9986757093583726, -0.9391874110758736, -0.7299482786626712, -0.4043209128544033, -0.014225696175907986, 0.37813776839785224, 0.7102082120408555, 0.929037921294371, 0.9997351044810018, 0.9110272913482331, 0.6770586972612659, 0.335134967197576, -0.060225106126626834, -0.4459824529111488, -0.7606291315335032, -0.9539955996590277, -0.9952501089559018, -0.8778147420606648, -0.6204142433018863, -0.26409041002502937, 0.13434190843889393, 0.5113537813025197, 0.8068317085628699, 0.9736625522534111};
// exp(-2t)u(t)
//x = {1.0, 0.904382840091222, 0.8179083214514649, 0.73970225068852, 0.6689740222995528, 0.6050086262345181, 0.5471594196736621, 0.49484158994713145, 0.44752624251164264, 0.40473505421803235, 0.3660354378181788, 0.3310361688280385, 0.29938343053761873, 0.2707572371858647, 0.24486819914140498, 0.22145459738752676, 0.20027973773658958, 0.181129558026942, 0.16381046411287362, 0.14814737277106185, 0.13398194173874586, 0.12117096899062363, 0.10958494507234559, 0.09910674385576848, 0.08963043848047317, 0.08106023051159188, 0.0733094814885226, 0.06629983707420493, 0.05996043495075476, 0.05422718845386856, 0.04904213870407158, 0.044352868685335896, 0.04011197334783711, 0.03627658037798032, 0.03280791679103535, 0.02967091696495304, 0.02683386815287505, 0.024268089890730534, 0.021947644058967954, 0.019849072667360676, 0.01795116071208469, 0.016234721707729115, 0.014682403726126671, 0.01327851398120038, 0.012008860186509, 0.010860607081733413, 0.009822146677692902, 0.008882980908164468, 0.008033615502201885, 0.00726546400408221, 0.006570760970592411, 0.00594248346814492, 0.0053742800761160375, 0.004860406678683492, 0.004395668396066119, 0.003975367068133504, 0.003595253759483693, 0.003251485805850506, 0.002940587967611376, 0.002659417297686451, 0.0024051313686693954, 0.002175159537989716, 0.00196717696061865, 0.0017790810866063125, 0.0016089704058575942, 0.0014551252252722174, 0.0013159902839200673, 0.0011901590305040842, 0.001076359404167499, 0.0009734409748998982, 0.000880363313541138, 0.0007961854738124534, 0.0007200564800458819, 0.0006512067244499831, 0.0005889401869445776, 0.0005326273989127923, 0.00048169907973915135, 0.0004356403818038218, 0.0003939856857541647, 0.00035631389343763917, 0.00032224417091109285, 0.0002914320984914153, 0.00026356618892741095, 0.00023836473849419152, 0.00021557297917697838, 0.00019496050315500157, 0.000176318933548934, 0.00015945981788484037, 0.000144212722979121, 0.00013042351198514607, 0.00011795278618379795, 0.00010667447576557585, 9.647456535811373e-05, 8.724994141513712e-05, 7.890734981481444e-05, 7.136245312959346e-05, 6.453897803721844e-05, 5.836794425388462e-05, 5.27869671946143e-05, 4.773962731126745e-05, 4.3174899732660524e-05, 3.904663844087727e-05, 3.5313109769175675e-05, 3.1936570505500176e-05, 2.8882886336537804e-05, 2.6121186775070012e-05, 2.3623553082191087e-05, 2.1364736029517717e-05, 1.9321900648174492e-05, 1.747439538415647e-05, 1.580354332640037e-05, 1.4292453397034646e-05, 1.2925849595081628e-05, 1.1689916567391896e-05, 1.0572159945647313e-05, 9.561280037543177e-06, 8.647057595260804e-06, 7.820250506434338e-06, 7.072500363233905e-06, 6.396247965047679e-06, 5.784656900557519e-06, 5.231544436679495e-06, 4.731319015707634e-06, 4.2789237288032756e-06, 3.869785194388829e-06, 3.4997673246443303e-06, 3.1651295127202977e-06, 2.8624888179705283e-06, 2.5887857669255516e-06, 2.341253424279863e-06, 2.1173894212235213e-06, 1.914930658345237e-06, 1.7318304273720192e-06, 1.5662377204631017e-06};
// exp(0.25t)u(t)
//x = {1.0, 0.9833614519813629, 0.9669997452428942, 0.9509102735476606, 0.9350885072998224, 0.9195299922694387, 0.9042303483384866, 0.8891852682677477, 0.8743905164842101, 0.8598419278886467, 0.8455354066830338, 0.8314669252174803, 0.8176325228563408, 0.8040283048631961, 0.7906504413043864, 0.7774951659707867, 0.7645587753175236, 0.7518376274213326, 0.7393281409552646, 0.7270267941804507, 0.7149301239546435, 0.7030347247572539, 0.691337247730611, 0.6798343997371729, 0.6685229424324246, 0.6573996913532021, 0.6464615150211847, 0.6357053340613038, 0.625128120334821, 0.6147268960868297, 0.6044987331079412, 0.5944407519099195, 0.5845501209150316, 0.5748240556588866, 0.5652598180065386, 0.5558547153816307, 0.5466061000083675, 0.5375113681660983, 0.5285679594563034, 0.5197733560817767, 0.5111250821378018, 0.5026207029151223, 0.49425782421450787, 0.48603409167272765, 0.4779471900997363, 0.4699948428268892, 0.46217481106600217, 0.45448489327907593, 0.4469229245585069, 0.43948677601761044, 0.4321743541912854, 0.42498360044665023, 0.4179124904034854, 0.4109590333643187, 0.4041212717539938, 0.39739728056856227, 0.39078516683334646, 0.38428306907001875, 0.377889156772548, 0.3716016298918657, 0.365418718329106, 0.35933868143727843, 0.3533598075312305, 0.34748041340576574, 0.341698843861778, 0.33601347124027103, 0.33042269496413085, 0.3249249410875226, 0.31951866185278516, 0.3142023352546969, 0.3089744646119937, 0.3038335781460143, 0.29877822856635755, 0.29380699266343285, 0.28891847090779094, 0.2841112870561205, 0.27938408776380047, 0.27473554220389934, 0.2701643416925134, 0.26566919932033906, 0.2612488495903747, 0.25690204806165157, 0.2526275709988916, 0.24842421502799486, 0.24429079679725935, 0.24022615264423702, 0.2362291382681334, 0.2322986284076578, 0.22843351652423344, 0.2246327144904789, 0.22089515228387227, 0.21721977768551287, 0.2136055559838948, 0.21005146968360908, 0.20655651821889304, 0.2031197176719455, 0.19974010049592886, 0.19641671524257995, 0.19314862629435328, 0.18993491360102088, 0.1867746724206546, 0.18366701306491834, 0.18061106064859803, 0.17760595484329936, 0.17465084963524324, 0.17174491308709147, 0.16888732710373525, 0.16607728720198048, 0.1633140022840653, 0.1605966944149461, 0.1579245986032886, 0.15529696258610384, 0.15271304661696644, 0.15017212325775767, 0.14767347717387277, 0.1452164049328362, 0.14280021480626734, 0.14042422657514156, 0.13808777133829112, 0.13579019132409237, 0.1335308397052865, 0.1313090804168812, 0.12912428797708186, 0.12697584731120282, 0.12486315357850826, 0.12278561200193376, 0.12074263770064186, 0.1187336555253628, 0.11675809989647576, 0.11481541464478344, 0.11290505285493645, 0.11102647671146285, 0.10917915734735906, 0.1073625746952007, 0.10557621734073007, 0.10381958237888028, 0.10209217527219444, 0.1003935097116009, 0.09872310747950494, 0.0970804983151581, 0.09546521978226814, 0.0938768171388111, 0.09231484320901019, 0.09077885825744414, 0.08926842986525058, 0.08778313280838929, 0.08632254893793048};

	vector<pair<double, double>> X = dtft(x);
	ofstream outFile("dft_result.txt");
	for (int i = 0; i < X.size(); i++)
	{
		outFile << X[i].first << "	" << X[i].second << "\n";
	}
	outFile.close();

	ofstream inFile("ip_signal.txt");
	for (int i = 0; i < x.size(); i++)
	{
		inFile << i << "	" << x[i]
            << "\n";
	}
	inFile.close();

	return 0;
}
